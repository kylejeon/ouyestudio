{"version":3,"file":"page-OFSAPkR5.js","sources":["../../src/pages/photo-editor/components/PhotoCanvas.tsx","../../src/pages/photo-editor/components/PhotoUploader.tsx","../../src/pages/photo-editor/components/LayoutSelector.tsx","../../src/pages/photo-editor/components/TextEditor.tsx","../../src/pages/photo-editor/page.tsx"],"sourcesContent":["import { forwardRef, useEffect, useRef, useState, useCallback } from 'react';\nimport { PhotoItem, TextItem, LayoutTemplate } from '../page';\n\ninterface PhotoCanvasProps {\n  photos: PhotoItem[];\n  texts: TextItem[];\n  layout: LayoutTemplate;\n  isTextMode: boolean;\n  onAddText: (x: number, y: number) => void;\n  onUpdatePhoto: (id: string, updates: Partial<PhotoItem>) => void;\n  onUpdateText: (id: string, updates: Partial<TextItem>) => void;\n  showGuides?: boolean;\n}\n\n// ë””ë°”ìš´ìŠ¤ í•¨ìˆ˜ êµ¬í˜„\nfunction debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout | null = null;\n  return (...args: Parameters<T>) => {\n    if (timeout) clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\nconst PhotoCanvas = forwardRef<HTMLCanvasElement, PhotoCanvasProps>(({\n  photos,\n  texts,\n  layout,\n  isTextMode,\n  onAddText,\n  onUpdatePhoto,\n  onUpdateText,\n  showGuides = true\n}, ref) => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragTarget, setDragTarget] = useState<{ type: 'photo' | 'text'; id: string } | null>(null);\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n  const [loadedImages, setLoadedImages] = useState<Map<string, HTMLImageElement>>(new Map());\n  const [isRendering, setIsRendering] = useState(false);\n  const [fontsLoaded, setFontsLoaded] = useState(false);\n  const renderTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // í°íŠ¸ ë¡œë”© í™•ì¸\n  useEffect(() => {\n    const checkFonts = async () => {\n      try {\n        // í°íŠ¸ê°€ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼\n        await document.fonts.ready;\n        setFontsLoaded(true);\n      } catch (error) {\n        console.error('í°íŠ¸ ë¡œë”© ì˜¤ë¥˜:', error);\n        setFontsLoaded(true); // ì˜¤ë¥˜ê°€ ìˆì–´ë„ ë Œë”ë§ ì§„í–‰\n      }\n    };\n\n    checkFonts();\n  }, []);\n\n  // ê°€ë¡œ ëª¨ë“œì¸ì§€ í™•ì¸\n  const isHorizontalMode = layout.id === 'horizontal-2';\n  \n  // ìº”ë²„ìŠ¤ í¬ê¸° ì„¤ì • - 4x6 ì¸í™”ì§€ ë¹„ìœ¨ (2:3)ì— ë§ì¶¤\n  const CANVAS_WIDTH = isHorizontalMode ? 2400 : 1600;\n  const CANVAS_HEIGHT = isHorizontalMode ? 1600 : 2400;\n  \n  // ëª¨ë°”ì¼ ë°˜ì‘í˜• í‘œì‹œ í¬ê¸° ì„¤ì •\n  const getDisplaySize = () => {\n    const isMobile = window.innerWidth < 640; // sm breakpoint\n    const isTablet = window.innerWidth < 1024; // lg breakpoint\n    \n    if (isMobile) {\n      // ëª¨ë°”ì¼: í™”ë©´ ë„ˆë¹„ì˜ 90%ì— ë§ì¶¤\n      const maxWidth = Math.min(window.innerWidth * 0.9, 320);\n      if (isHorizontalMode) {\n        return {\n          width: maxWidth,\n          height: (maxWidth * 2) / 3  // ê°€ë¡œ ëª¨ë“œ: 3:2 ë¹„ìœ¨ (ê°€ë¡œê°€ ë” ê¹€)\n        };\n      } else {\n        return {\n          width: maxWidth,\n          height: (maxWidth * 3) / 2  // ì„¸ë¡œ ëª¨ë“œ: 2:3 ë¹„ìœ¨ (ì„¸ë¡œê°€ ë” ê¹€)\n        };\n      }\n    } else if (isTablet) {\n      // íƒœë¸”ë¦¿: ì¤‘ê°„ í¬ê¸°\n      if (isHorizontalMode) {\n        return { width: 600, height: 400 };  // 3:2 ë¹„ìœ¨ (ê°€ë¡œê°€ ë” ê¹€)\n      } else {\n        return { width: 320, height: 480 };  // 2:3 ë¹„ìœ¨\n      }\n    } else {\n      // ë°ìŠ¤í¬í†±: ê¸°ì¡´ í¬ê¸°\n      if (isHorizontalMode) {\n        return { width: 600, height: 400 };  // 3:2 ë¹„ìœ¨ (ê°€ë¡œê°€ ë” ê¹€)\n      } else {\n        return { width: 400, height: 600 };  // 2:3 ë¹„ìœ¨\n      }\n    }\n  };\n\n  const [displaySize, setDisplaySize] = useState(getDisplaySize());\n\n  // í™”ë©´ í¬ê¸° ë³€ê²½ ê°ì§€\n  useEffect(() => {\n    const handleResize = () => {\n      setDisplaySize(getDisplaySize());\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [isHorizontalMode]);\n\n  // ë ˆì´ì•„ì›ƒ ë³€ê²½ ì‹œ displaySize ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    setDisplaySize(getDisplaySize());\n  }, [isHorizontalMode]);\n\n  // ì´ë¯¸ì§€ ë¡œë“œ ë° ìºì‹±\n  useEffect(() => {\n    const loadImages = async () => {\n      const newLoadedImages = new Map<string, HTMLImageElement>();\n      \n      for (const photo of photos) {\n        if (loadedImages.has(photo.id)) {\n          newLoadedImages.set(photo.id, loadedImages.get(photo.id)!);\n        } else {\n          try {\n            const img = new Image();\n            img.crossOrigin = 'anonymous';\n            \n            await new Promise<void>((resolve, reject) => {\n              img.onload = () => resolve();\n              img.onerror = () => reject();\n              img.src = photo.src;\n            });\n            \n            newLoadedImages.set(photo.id, img);\n          } catch (error) {\n            console.error('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', photo.src);\n          }\n        }\n      }\n      \n      setLoadedImages(newLoadedImages);\n    };\n\n    if (photos.length > 0) {\n      loadImages();\n    } else {\n      setLoadedImages(new Map());\n    }\n  }, [photos]);\n\n  // ìº”ë²„ìŠ¤ ë Œë”ë§ í•¨ìˆ˜\n  const renderCanvasInternal = useCallback(async () => {\n    if (isRendering || !canvasRef.current || !fontsLoaded) return;\n    \n    setIsRendering(true);\n    \n    try {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n\n      // ìº”ë²„ìŠ¤ í¬ê¸° ì„¤ì •\n      canvas.width = CANVAS_WIDTH;\n      canvas.height = CANVAS_HEIGHT;\n\n      // ë°°ê²½ ê·¸ë¦¬ê¸°\n      ctx.fillStyle = '#ffffff';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n      // ë ˆì´ì•„ì›ƒ ìŠ¬ë¡¯ ê·¸ë¦¬ê¸° (ê°€ì´ë“œ)\n      if (showGuides) {\n        ctx.strokeStyle = '#e5e7eb';\n        ctx.lineWidth = 2;\n        layout.slots.forEach((slot) => {\n          const x = slot.x * CANVAS_WIDTH;\n          const y = slot.y * CANVAS_HEIGHT;\n          const width = slot.width * CANVAS_WIDTH;\n          const height = slot.height * CANVAS_HEIGHT;\n          ctx.strokeRect(x, y, width, height);\n        });\n      }\n\n      // ì‚¬ì§„ ë Œë”ë§\n      for (const photo of photos) {\n        const img = loadedImages.get(photo.id);\n        if (img && img.complete) {\n          ctx.save();\n\n          // ìŠ¬ë¡¯ ì˜ì—­ìœ¼ë¡œ í´ë¦¬í•‘\n          const slotX = photo.slotX * CANVAS_WIDTH;\n          const slotY = photo.slotY * CANVAS_HEIGHT;\n          const slotWidth = photo.slotWidth * CANVAS_WIDTH;\n          const slotHeight = photo.slotHeight * CANVAS_HEIGHT;\n\n          ctx.beginPath();\n          ctx.rect(slotX, slotY, slotWidth, slotHeight);\n          ctx.clip();\n\n          // ì‚¬ì§„ ìœ„ì¹˜ ê³„ì‚°\n          const photoX = slotX + slotWidth / 2 + photo.x * slotWidth;\n          const photoY = slotY + slotHeight / 2 + photo.y * slotHeight;\n\n          ctx.translate(photoX, photoY);\n          ctx.rotate((photo.rotation * Math.PI) / 180);\n\n          // ì´ë¯¸ì§€ í¬ê¸° ê³„ì‚° - ì›ë³¸ ë¹„ìœ¨ ìœ ì§€í•˜ë©´ì„œ ìŠ¤ì¼€ì¼ ì ìš©\n          const originalWidth = img.width;\n          const originalHeight = img.height;\n          \n          // ìŠ¤ì¼€ì¼ì„ ì ìš©í•œ ì‹¤ì œ ê·¸ë¦¬ê¸° í¬ê¸°\n          const drawWidth = originalWidth * photo.scale;\n          const drawHeight = originalHeight * photo.scale;\n\n          // ì´ë¯¸ì§€ í’ˆì§ˆ ìµœì í™”\n          ctx.imageSmoothingEnabled = photo.scale < 1;\n          ctx.imageSmoothingQuality = photo.scale < 1 ? 'low' : 'high';\n\n          // ì›ë³¸ ë¹„ìœ¨ì„ ìœ ì§€í•˜ë©´ì„œ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°\n          ctx.drawImage(img, -drawWidth / 2, -drawHeight / 2, drawWidth, drawHeight);\n          ctx.restore();\n        }\n      }\n\n      // í…ìŠ¤íŠ¸ ë Œë”ë§\n      texts.forEach((text) => {\n        ctx.save();\n        const x = text.x * CANVAS_WIDTH;\n        const y = text.y * CANVAS_HEIGHT;\n\n        ctx.translate(x, y);\n\n        // í°íŠ¸ ì„¤ì • - í•œê¸€ í°íŠ¸ë¥¼ ìš°ì„ ìœ¼ë¡œ ì„¤ì •\n        const fontFamily = text.fontFamily === 'Arial' || text.fontFamily === 'serif' || text.fontFamily === 'sans-serif' \n          ? `\"Apple Color Emoji\", \"Segoe UI Emoji\", \"Noto Color Emoji\", ${text.fontFamily}` \n          : `\"${text.fontFamily}\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Noto Color Emoji\", \"Malgun Gothic\", sans-serif`;\n\n        if (isHorizontalMode) {\n          // ì„¸ë¡œ í…ìŠ¤íŠ¸ (ê°€ë¡œ ëª¨ë“œì—ì„œ)\n          ctx.font = `${text.fontSize * 2}px ${fontFamily}`;\n          ctx.fillStyle = text.color;\n          ctx.textAlign = 'center';\n          ctx.textBaseline = 'middle';\n\n          const chars = text.text.split('');\n          const lineHeight = text.fontSize * 2.4;\n          const startY = -(chars.length - 1) * lineHeight / 2;\n\n          chars.forEach((char, index) => {\n            ctx.fillText(char, 0, startY + index * lineHeight);\n          });\n        } else {\n          // ê°€ë¡œ í…ìŠ¤íŠ¸\n          ctx.rotate((text.rotation * Math.PI) / 180);\n          ctx.font = `${text.fontSize * 2}px ${fontFamily}`;\n          ctx.fillStyle = text.color;\n          ctx.textAlign = 'center';\n          ctx.textBaseline = 'middle';\n          ctx.fillText(text.text, 0, 0);\n        }\n\n        ctx.restore();\n      });\n\n    } catch (error) {\n      console.error('Canvas rendering error:', error);\n    } finally {\n      setIsRendering(false);\n    }\n  }, [photos, texts, layout, loadedImages, isRendering, showGuides, isHorizontalMode, CANVAS_WIDTH, CANVAS_HEIGHT, fontsLoaded]);\n\n  // ë””ë°”ìš´ì‹±ëœ ë Œë”ë§ í•¨ìˆ˜\n  const debouncedRender = useCallback(\n    debounce(renderCanvasInternal, 30),\n    [renderCanvasInternal]\n  );\n\n  useEffect(() => {\n    debouncedRender();\n    \n    return () => {\n      if (renderTimeoutRef.current) {\n        clearTimeout(renderTimeoutRef.current);\n      }\n    };\n  }, [debouncedRender]);\n\n  const handleCanvasClick = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (!isTextMode) return;\n\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n\n    onAddText(x, y);\n  };\n\n  const getEventPosition = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return { x: 0, y: 0 };\n\n    const rect = canvas.getBoundingClientRect();\n    let clientX, clientY;\n\n    if ('touches' in e) {\n      if (e.touches.length > 0) {\n        clientX = e.touches[0].clientX;\n        clientY = e.touches[0].clientY;\n      } else if (e.changedTouches.length > 0) {\n        clientX = e.changedTouches[0].clientX;\n        clientY = e.changedTouches[0].clientY;\n      } else {\n        return { x: 0, y: 0 };\n      }\n    } else {\n      clientX = e.clientX;\n      clientY = e.clientY;\n    }\n\n    return {\n      x: (clientX - rect.left) / rect.width,\n      y: (clientY - rect.top) / rect.height\n    };\n  };\n\n  const handleStart = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    if (isTextMode) return;\n\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    const { x, y } = getEventPosition(e);\n\n    // í…ìŠ¤íŠ¸ í´ë¦­ í™•ì¸\n    for (const text of texts) {\n      const fontFamily = text.fontFamily === 'Arial' || text.fontFamily === 'serif' || text.fontFamily === 'sans-serif' \n        ? `\"Apple Color Emoji\", \"Segoe UI Emoji\", \"Noto Color Emoji\", ${text.fontFamily}` \n        : `\"${text.fontFamily}\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Noto Color Emoji\", \"Malgun Gothic\", sans-serif`;\n      \n      ctx.font = `${text.fontSize * 2}px ${fontFamily}`;\n      \n      let textWidth, textHeight;\n      \n      if (isHorizontalMode) {\n        const chars = text.text.split('');\n        const lineHeight = text.fontSize * 2.4;\n        textWidth = (text.fontSize * 2 + 80) / CANVAS_WIDTH;\n        textHeight = (chars.length * lineHeight + 80) / CANVAS_HEIGHT;\n      } else {\n        const textMetrics = ctx.measureText(text.text);\n        textWidth = (textMetrics.width + 80) / CANVAS_WIDTH;\n        textHeight = (text.fontSize * 2 + 80) / CANVAS_HEIGHT;\n      }\n      \n      if (x >= text.x - textWidth / 2 && x <= text.x + textWidth / 2 &&\n          y >= text.y - textHeight / 2 && y <= text.y + textHeight / 2) {\n        setIsDragging(true);\n        setDragTarget({ type: 'text', id: text.id });\n        setDragOffset({\n          x: x - text.x,\n          y: y - text.y\n        });\n        e.preventDefault();\n        return;\n      }\n    }\n\n    // ì‚¬ì§„ í´ë¦­ í™•ì¸\n    for (const photo of photos) {\n      const slotX = photo.slotX;\n      const slotY = photo.slotY;\n      const slotWidth = photo.slotWidth;\n      const slotHeight = photo.slotHeight;\n      \n      if (x >= slotX && x <= slotX + slotWidth &&\n          y >= slotY && y <= slotY + slotHeight) {\n        setIsDragging(true);\n        setDragTarget({ type: 'photo', id: photo.id });\n        \n        const relativeX = (x - slotX - slotWidth / 2) / slotWidth;\n        const relativeY = (y - slotY - slotHeight / 2) / slotHeight;\n        \n        setDragOffset({\n          x: relativeX - photo.x,\n          y: relativeY - photo.y\n        });\n        e.preventDefault();\n        return;\n      }\n    }\n  };\n\n  const handleMove = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    if (!isDragging || !dragTarget) return;\n\n    const { x, y } = getEventPosition(e);\n\n    if (dragTarget.type === 'text') {\n      const newX = x - dragOffset.x;\n      const newY = y - dragOffset.y;\n      onUpdateText(dragTarget.id, { \n        x: Math.max(0, Math.min(1, newX)), \n        y: Math.max(0, Math.min(1, newY)) \n      });\n    } else if (dragTarget.type === 'photo') {\n      const photo = photos.find(p => p.id === dragTarget.id);\n      if (!photo) return;\n      \n      const slotX = photo.slotX;\n      const slotY = photo.slotY;\n      const slotWidth = photo.slotWidth;\n      const slotHeight = photo.slotHeight;\n      \n      if (x >= slotX && x <= slotX + slotWidth &&\n          y >= slotY && y <= slotY + slotHeight) {\n        const relativeX = (x - slotX - slotWidth / 2) / slotWidth;\n        const relativeY = (y - slotY - slotHeight / 2) / slotHeight;\n        \n        const newX = relativeX - dragOffset.x;\n        const newY = relativeY - dragOffset.y;\n        \n        onUpdatePhoto(dragTarget.id, { \n          x: Math.max(-1, Math.min(1, newX)), \n          y: Math.max(-1, Math.min(1, newY)) \n        });\n      }\n    }\n\n    e.preventDefault();\n  };\n\n  const handleEnd = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    setIsDragging(false);\n    setDragTarget(null);\n    setDragOffset({ x: 0, y: 0 });\n    e.preventDefault();\n  };\n\n  return (\n    <div className=\"relative\">\n      <canvas\n        ref={(node) => {\n          canvasRef.current = node;\n          if (typeof ref === 'function') {\n            ref(node);\n          } else if (ref) {\n            ref.current = node;\n          }\n        }}\n        width={CANVAS_WIDTH}\n        height={CANVAS_HEIGHT}\n        className={`border-2 border-gray-300 rounded-lg shadow-lg ${\n          isTextMode ? 'cursor-crosshair' : 'cursor-move'\n        }`}\n        style={{ \n          width: `${displaySize.width}px`,\n          height: `${displaySize.height}px`,\n          touchAction: 'none'\n        }}\n        onClick={handleCanvasClick}\n        onMouseDown={handleStart}\n        onMouseMove={handleMove}\n        onMouseUp={handleEnd}\n        onMouseLeave={handleEnd}\n        onTouchStart={handleStart}\n        onTouchMove={handleMove}\n        onTouchEnd={handleEnd}\n      />\n      \n      <div className=\"mt-2 text-sm text-gray-500 text-center\">\n        {isTextMode ? 'í´ë¦­í•˜ì—¬ í…ìŠ¤íŠ¸ ì¶”ê°€' : 'ì‚¬ì§„ê³¼ í…ìŠ¤íŠ¸ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ìœ„ì¹˜ ì¡°ì •'}\n      </div>\n    </div>\n  );\n});\n\nPhotoCanvas.displayName = 'PhotoCanvas';\n\nexport default PhotoCanvas;\n","\nimport { useRef } from 'react';\n\ninterface PhotoUploaderProps {\n  onUpload: (files: FileList) => void;\n}\n\nexport default function PhotoUploader({ onUpload }: PhotoUploaderProps) {\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (files && files.length > 0) {\n      onUpload(files);\n    }\n  };\n\n  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    const files = e.dataTransfer.files;\n    if (files && files.length > 0) {\n      onUpload(files);\n    }\n  };\n\n  const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n  };\n\n  const handleClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div\n        onClick={handleClick}\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n        className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors cursor-pointer\"\n      >\n        <div className=\"space-y-2\">\n          <div className=\"w-12 h-12 mx-auto flex items-center justify-center bg-gray-100 rounded-full\">\n            <i className=\"ri-upload-cloud-2-line text-xl text-gray-500\"></i>\n          </div>\n          <div>\n            <p className=\"text-sm font-medium text-gray-900\">ì‚¬ì§„ ì—…ë¡œë“œ</p>\n            <p className=\"text-xs text-gray-500\">í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œ</p>\n          </div>\n        </div>\n      </div>\n\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        multiple\n        accept=\"image/*\"\n        onChange={handleFileSelect}\n        className=\"hidden\"\n      />\n\n      <div className=\"text-xs text-gray-500\">\n        <p>â€¢ JPG, PNG íŒŒì¼ ì§€ì›</p>\n        <p>â€¢ ì—¬ëŸ¬ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ ê°€ëŠ¥</p>\n        <p>â€¢ ì„ íƒí•œ ë ˆì´ì•„ì›ƒì— ë§ê²Œ ìë™ ë°°ì¹˜</p>\n      </div>\n    </div>\n  );\n}\n","import { LayoutTemplate } from '../page';\n\ninterface LayoutSelectorProps {\n  layouts: LayoutTemplate[];\n  selectedLayout: LayoutTemplate;\n  onLayoutChange: (layout: LayoutTemplate) => void;\n}\n\nexport default function LayoutSelector({ layouts, selectedLayout, onLayoutChange }: LayoutSelectorProps) {\n  return (\n    <div className=\"space-y-3\">\n      {layouts.map((layout) => (\n        <button\n          key={layout.id}\n          onClick={() => onLayoutChange(layout)}\n          className={`w-full p-3 rounded-lg border-2 transition-all whitespace-nowrap cursor-pointer ${\n            selectedLayout.id === layout.id\n              ? 'border-blue-500 bg-blue-50 text-blue-700'\n              : 'border-gray-200 hover:border-gray-300 text-gray-700'\n          }`}\n        >\n          <div className=\"flex items-center justify-between\">\n            <div className=\"text-left\">\n              <div className=\"font-medium\">{layout.name}</div>\n              <div className=\"text-xs text-gray-500\">\n                {layout.slots.length}ê°œ ìŠ¬ë¡¯\n              </div>\n            </div>\n            \n            {/* ë ˆì´ì•„ì›ƒ ë¯¸ë¦¬ë³´ê¸° */}\n            <div className={`bg-white border border-gray-300 rounded relative overflow-hidden ${\n              layout.id === 'horizontal-2' ? 'w-12 h-8' : 'w-8 h-12'\n            }`}>\n              {layout.slots.map((slot, index) => (\n                <div\n                  key={index}\n                  className=\"absolute bg-gray-200 border border-gray-400\"\n                  style={{\n                    left: `${slot.x * 100}%`,\n                    top: `${slot.y * 100}%`,\n                    width: `${slot.width * 100}%`,\n                    height: `${slot.height * 100}%`,\n                  }}\n                />\n              ))}\n            </div>\n          </div>\n        </button>\n      ))}\n      \n      <div className=\"text-xs text-gray-500 mt-3\">\n        <p>â€¢ ë ˆì´ì•„ì›ƒ ë³€ê²½ ì‹œ ê¸°ì¡´ ì‚¬ì§„ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤</p>\n      </div>\n    </div>\n  );\n}\n","import { TextItem } from '../page';\n\ninterface TextEditorProps {\n  texts: TextItem[];\n  onUpdateText: (id: string, updates: Partial<TextItem>) => void;\n  onDeleteText: (id: string) => void;\n}\n\nconst fontOptions = [\n  { value: 'Arial', label: 'Arial' },\n  { value: 'Helvetica', label: 'Helvetica' },\n  { value: 'Times New Roman', label: 'Times New Roman' },\n  { value: 'Georgia', label: 'Georgia' },\n  { value: 'Verdana', label: 'Verdana' },\n  { value: 'Noto Sans KR', label: 'ë…¸í†  ì‚°ìŠ¤' },\n  { value: 'Nanum Gothic', label: 'ë‚˜ëˆ”ê³ ë”•' },\n  { value: 'Nanum Myeongjo', label: 'ë‚˜ëˆ”ëª…ì¡°' },\n  { value: 'Nanum Pen Script', label: 'ë‚˜ëˆ”íœìŠ¤í¬ë¦½íŠ¸' },\n  { value: 'Cute Font', label: 'ííŠ¸í°íŠ¸' },\n  { value: 'Jua', label: 'ì£¼ì•„' },\n  { value: 'Sunflower', label: 'í•´ë°”ë¼ê¸°' },\n  { value: 'Gamja Flower', label: 'ê°ìê½ƒ' },\n  { value: 'Stylish', label: 'ìŠ¤íƒ€ì¼ë¦¬ì‹œ' },\n  { value: 'Poor Story', label: 'ê°€ë‚œí•œ ì´ì•¼ê¸°' },\n  { value: 'Gaegu', label: 'ê°œêµ¬' },\n  { value: 'Do Hyeon', label: 'ë„í˜„' },\n  { value: 'Black Han Sans', label: 'ê²€ì€ê³ ë”•' },\n  { value: 'Song Myung', label: 'ì†¡ëª…' },\n  { value: 'Yeon Sung', label: 'ì—°ì„±' },\n  { value: 'Gowun Batang', label: 'ê³ ìš´ë°”íƒ•ì²´' },\n  { value: 'Dongle', label: 'ë™ê¸€' },\n  { value: 'Single Day', label: 'ì‹±ê¸€ë°ì´' }\n];\n\nconst specialCharacters = [\n  'â™¡', 'â¤ï¸', 'ğŸ’™', 'â˜…', 'â˜†', 'â™ª', 'â™«', 'â™¬', 'â™©',\n  'â˜º', 'ğŸ˜Š', 'ğŸ˜', 'ğŸ˜˜', 'ğŸ˜', 'ğŸ˜¢', 'ğŸ˜‚',\n  'â™ ', 'â™£', 'â™¦', 'â™§', 'â™¤', 'â™¢', 'â™›', 'â™š',\n  'â˜€', 'â˜', 'â˜‚', 'â˜ƒ', 'â„', 'âš¡', 'ğŸŒ™', 'â­',\n  'â†’', 'â†', 'â†‘', 'â†“', 'â†—', 'â†–', 'â†˜', 'â†™',\n  'âœ“', 'âœ—', 'âœ•', 'âœ–', 'â—‹', 'â—', 'â—¯', 'â—‰'\n];\n\nexport default function TextEditor({ texts, onUpdateText, onDeleteText }: TextEditorProps) {\n  const handleAddSpecialChar = (textId: string, char: string) => {\n    const text = texts.find(t => t.id === textId);\n    if (text) {\n      onUpdateText(textId, { text: text.text + char });\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <h4 className=\"font-medium text-gray-700\">í…ìŠ¤íŠ¸ í¸ì§‘</h4>\n      {texts.map((text, index) => (\n        <div key={text.id} className=\"p-3 bg-gray-50 rounded-lg space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm font-medium text-gray-600\">í…ìŠ¤íŠ¸ {index + 1}</span>\n            <button\n              onClick={() => onDeleteText(text.id)}\n              className=\"text-red-500 hover:text-red-700 cursor-pointer\"\n            >\n              <i className=\"ri-delete-bin-line\"></i>\n            </button>\n          </div>\n          \n          {/* í…ìŠ¤íŠ¸ ë‚´ìš© */}\n          <div>\n            <label className=\"block text-xs text-gray-600 mb-1\">ë‚´ìš©</label>\n            <input\n              type=\"text\"\n              value={text.text}\n              onChange={(e) => onUpdateText(text.id, { text: e.target.value })}\n              className=\"w-full px-2 py-1 text-sm border border-gray-300 rounded\"\n              style={{ \n                fontFamily: text.fontFamily,\n                fontVariantEmoji: 'emoji'\n              }}\n            />\n          </div>\n\n          {/* íŠ¹ìˆ˜ë¬¸ì ì„ íƒ */}\n          <div>\n            <label className=\"block text-xs text-gray-600 mb-1\">íŠ¹ìˆ˜ë¬¸ì</label>\n            <div className=\"grid grid-cols-8 gap-1 p-2 bg-white border border-gray-200 rounded max-h-24 overflow-y-auto\">\n              {specialCharacters.map((char, charIndex) => (\n                <button\n                  key={charIndex}\n                  onClick={() => handleAddSpecialChar(text.id, char)}\n                  className=\"w-6 h-6 text-sm border border-gray-200 rounded hover:bg-blue-50 hover:border-blue-300 transition-colors cursor-pointer flex items-center justify-center\"\n                  title={`íŠ¹ìˆ˜ë¬¸ì ì¶”ê°€: ${char}`}\n                  style={{ \n                    fontVariantEmoji: 'emoji',\n                    fontFamily: 'Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif'\n                  }}\n                >\n                  {char}\n                </button>\n              ))}\n            </div>\n          </div>\n          \n          {/* í°íŠ¸ ì„ íƒ */}\n          <div>\n            <label className=\"block text-xs text-gray-600 mb-1\">í°íŠ¸</label>\n            <select\n              value={text.fontFamily}\n              onChange={(e) => onUpdateText(text.id, { fontFamily: e.target.value })}\n              className=\"w-full px-2 py-1 text-sm border border-gray-300 rounded pr-8\"\n              style={{ fontFamily: text.fontFamily }}\n            >\n              {fontOptions.map(font => (\n                <option key={font.value} value={font.value} style={{ fontFamily: font.value }}>\n                  {font.label}\n                </option>\n              ))}\n            </select>\n          </div>\n          \n          {/* í°íŠ¸ ë¯¸ë¦¬ë³´ê¸° */}\n          <div>\n            <label className=\"block text-xs text-gray-600 mb-1\">ë¯¸ë¦¬ë³´ê¸°</label>\n            <div \n              className=\"w-full px-2 py-2 text-sm border border-gray-200 rounded bg-white\"\n              style={{ \n                fontFamily: text.fontFamily,\n                fontSize: `${Math.min(text.fontSize, 16)}px`,\n                color: text.color,\n                fontVariantEmoji: 'emoji'\n              }}\n            >\n              {text.text || 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”'}\n            </div>\n          </div>\n          \n          {/* í¬ê¸° */}\n          <div>\n            <label className=\"block text-xs text-gray-600 mb-1\">í¬ê¸°: {text.fontSize}px</label>\n            <input\n              type=\"range\"\n              min=\"12\"\n              max=\"48\"\n              value={text.fontSize}\n              onChange={(e) => onUpdateText(text.id, { fontSize: parseInt(e.target.value) })}\n              className=\"w-full\"\n            />\n          </div>\n          \n          {/* ìƒ‰ìƒ */}\n          <div>\n            <label className=\"block text-xs text-gray-600 mb-1\">ìƒ‰ìƒ</label>\n            <input\n              type=\"color\"\n              value={text.color}\n              onChange={(e) => onUpdateText(text.id, { color: e.target.value })}\n              className=\"w-full h-8 border border-gray-300 rounded cursor-pointer\"\n            />\n          </div>\n          \n          {/* íšŒì „ */}\n          <div>\n            <label className=\"block text-xs text-gray-600 mb-1\">íšŒì „: {text.rotation}Â°</label>\n            <input\n              type=\"range\"\n              min=\"-180\"\n              max=\"180\"\n              value={text.rotation}\n              onChange={(e) => onUpdateText(text.id, { rotation: parseInt(e.target.value) })}\n              className=\"w-full\"\n            />\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n","import { useState, useRef, useCallback, useEffect } from 'react';\nimport PhotoCanvas from './components/PhotoCanvas';\nimport PhotoUploader from './components/PhotoUploader';\nimport LayoutSelector from './components/LayoutSelector';\nimport TextEditor from './components/TextEditor';\n\nexport interface PhotoItem {\n  id: string;\n  src: string;\n  x: number; // ìŠ¬ë¡¯ ë‚´ì—ì„œì˜ ìƒëŒ€ì  ìœ„ì¹˜ (-0.5 ~ 0.5)\n  y: number; // ìŠ¬ë¡¯ ë‚´ì—ì„œì˜ ìƒëŒ€ì  ìœ„ì¹˜ (-0.5 ~ 0.5)\n  width: number;\n  height: number;\n  rotation: number;\n  scale: number; // í™•ëŒ€/ì¶•ì†Œ ë¹„ìœ¨\n  slotX: number; // ìŠ¬ë¡¯ì˜ ì ˆëŒ€ ìœ„ì¹˜\n  slotY: number;\n  slotWidth: number; // ìŠ¬ë¡¯ì˜ í¬ê¸°\n  slotHeight: number;\n}\n\nexport interface TextItem {\n  id: string;\n  text: string;\n  x: number;\n  y: number;\n  fontSize: number;\n  fontFamily: string;\n  color: string;\n  rotation: number;\n}\n\nexport interface LayoutTemplate {\n  id: string;\n  name: string;\n  slots: Array<{\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  }>;\n}\n\nconst layouts: LayoutTemplate[] = [\n  {\n    id: 'single',\n    name: '1x1 (1ì¥)',\n    slots: [{ x: 0.02, y: 0.02, width: 0.96, height: 0.96 }],\n  },\n  {\n    id: 'vertical-2',\n    name: '1x2 ì„¸ë¡œ (2ì¥)',\n    slots: [\n      { x: 0.05, y: 0.025, width: 0.9, height: 0.41 },\n      { x: 0.05, y: 0.465, width: 0.9, height: 0.41 },\n    ],\n  },\n  {\n    id: 'horizontal-2',\n    name: '1x2 ê°€ë¡œ (2ì¥)',\n    slots: [\n      { x: 0.025, y: 0.02, width: 0.4375, height: 0.96 },\n      { x: 0.4875, y: 0.02, width: 0.4375, height: 0.96 },\n    ],\n  },\n  {\n    id: 'grid-4',\n    name: '2x2 (4ì¥)',\n    slots: [\n      { x: 0.025, y: 0.025, width: 0.4625, height: 0.4125 },\n      { x: 0.5125, y: 0.025, width: 0.4625, height: 0.4125 },\n      { x: 0.025, y: 0.4625, width: 0.4625, height: 0.4125 },\n      { x: 0.5125, y: 0.4625, width: 0.4625, height: 0.4125 },\n    ],\n  },\n  {\n    id: 'grid-9',\n    name: '3x3 (9ì¥)',\n    slots: [\n      { x: 0.025, y: 0.025, width: 0.3, height: 0.27 },\n      { x: 0.35, y: 0.025, width: 0.3, height: 0.27 },\n      { x: 0.675, y: 0.025, width: 0.3, height: 0.27 },\n      { x: 0.025, y: 0.32, width: 0.3, height: 0.27 },\n      { x: 0.35, y: 0.32, width: 0.3, height: 0.27 },\n      { x: 0.675, y: 0.32, width: 0.3, height: 0.27 },\n      { x: 0.025, y: 0.615, width: 0.3, height: 0.27 },\n      { x: 0.35, y: 0.615, width: 0.3, height: 0.27 },\n      { x: 0.675, y: 0.615, width: 0.3, height: 0.27 },\n    ],\n  },\n];\n\nexport default function PhotoEditor() {\n  const [photos, setPhotos] = useState<PhotoItem[]>([]);\n  const [texts, setTexts] = useState<TextItem[]>([]);\n  const [selectedLayout, setSelectedLayout] = useState<LayoutTemplate>(layouts[0]);\n  const [isTextMode, setIsTextMode] = useState(false);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const handlePhotoUpload = useCallback(\n    (files: FileList) => {\n      Array.from(files).forEach((file, index) => {\n        if (file.type.startsWith('image/')) {\n          const reader = new FileReader();\n          reader.onload = (e) => {\n            const currentPhotoCount = photos.length;\n            const slot = selectedLayout.slots[currentPhotoCount + index];\n            if (slot) {\n              const img = new Image();\n              img.onload = () => {\n                // 3x3 ë ˆì´ì•„ì›ƒì˜ ê²½ìš° ì´ë¯¸ì§€ ì••ì¶• ì²˜ë¦¬\n                let finalImageSrc = e.target?.result as string;\n                let finalImageWidth = img.width;\n                let finalImageHeight = img.height;\n                \n                if (selectedLayout.id === 'grid-9') {\n                  // 3x3 ë ˆì´ì•„ì›ƒì—ì„œë§Œ ì´ë¯¸ì§€ ì••ì¶•\n                  const canvas = document.createElement('canvas');\n                  const ctx = canvas.getContext('2d');\n                  \n                  if (ctx) {\n                    // ìµœëŒ€ í¬ê¸° ì„¤ì • (í™”ì§ˆ ìœ ì§€í•˜ë©´ì„œ ìš©ëŸ‰ ê°ì†Œ)\n                    const maxWidth = 1200;\n                    const maxHeight = 1200;\n                    \n                    let { width, height } = img;\n                    \n                    // ë¹„ìœ¨ ìœ ì§€í•˜ë©´ì„œ í¬ê¸° ì¡°ì •\n                    if (width > maxWidth || height > maxHeight) {\n                      const ratio = Math.min(maxWidth / width, maxHeight / height);\n                      width = width * ratio;\n                      height = height * ratio;\n                    }\n                    \n                    canvas.width = width;\n                    canvas.height = height;\n                    \n                    // ê³ í’ˆì§ˆ ë¦¬ìƒ˜í”Œë§ ì„¤ì •\n                    ctx.imageSmoothingEnabled = true;\n                    ctx.imageSmoothingQuality = 'high';\n                    \n                    // ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°\n                    ctx.drawImage(img, 0, 0, width, height);\n                    \n                    // ì••ì¶•ëœ ì´ë¯¸ì§€ë¡œ ë³€í™˜ (í’ˆì§ˆ 0.85ë¡œ ì„¤ì •)\n                    finalImageSrc = canvas.toDataURL('image/jpeg', 0.85);\n                    \n                    // ì••ì¶•ëœ ì´ë¯¸ì§€ì˜ ì‹¤ì œ í¬ê¸° ì—…ë°ì´íŠ¸\n                    finalImageWidth = width;\n                    finalImageHeight = height;\n                  }\n                }\n\n                // ìŠ¤ì¼€ì¼ ê³„ì‚° ë¡œì§ ê°œì„ \n                let optimalScale;\n                \n                if (selectedLayout.id === 'single') {\n                  // 1x1 ë ˆì´ì•„ì›ƒ: 4x6 ì¸í™”ì§€ ë¹„ìœ¨ (2:3) ê³ ë ¤\n                  // ìº”ë²„ìŠ¤ í¬ê¸°: 1600x2400 (2:3 ë¹„ìœ¨)\n                  const canvasWidth = 1600;\n                  const canvasHeight = 2400;\n                  const frameWidth = slot.width * canvasWidth;\n                  const frameHeight = slot.height * canvasHeight;\n                  \n                  // ì´ë¯¸ì§€ê°€ í”„ë ˆì„ì„ ì™„ì „íˆ ì±„ìš°ë„ë¡ í•˜ë˜, ì›ë³¸ ë¹„ìœ¨ ìœ ì§€\n                  const scaleX = frameWidth / finalImageWidth;\n                  const scaleY = frameHeight / finalImageHeight;\n                  \n                  // ë” í° ìŠ¤ì¼€ì¼ì„ ì‚¬ìš©í•˜ì—¬ í”„ë ˆì„ì„ ì™„ì „íˆ ì±„ì›€ (crop íš¨ê³¼)\n                  optimalScale = Math.max(scaleX, scaleY);\n                } else {\n                  // ë‹¤ë¥¸ ë ˆì´ì•„ì›ƒë“¤ì˜ ê¸°ì¡´ ë¡œì§ ìœ ì§€\n                  const frameAspectRatio = slot.width / slot.height;\n                  const imageAspectRatio = finalImageWidth / finalImageHeight;\n\n                  if (imageAspectRatio > frameAspectRatio) {\n                    optimalScale =\n                      (slot.width *\n                        (selectedLayout.id === 'horizontal-2' ? 2400 : 1600)) /\n                      finalImageWidth;\n                  } else {\n                    optimalScale =\n                      (slot.height *\n                        (selectedLayout.id === 'horizontal-2' ? 1600 : 2400)) /\n                      finalImageHeight;\n                  }\n                }\n\n                const newPhoto: PhotoItem = {\n                  id: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}-${index}`,\n                  src: finalImageSrc,\n                  x: 0,\n                  y: 0,\n                  width: slot.width,\n                  height: slot.height,\n                  rotation: 0,\n                  scale: optimalScale,\n                  slotX: slot.x,\n                  slotY: slot.y,\n                  slotWidth: slot.width,\n                  slotHeight: slot.height,\n                };\n                setPhotos((prev) => [...prev, newPhoto]);\n              };\n              img.src = e.target?.result as string;\n            }\n          };\n          reader.readAsDataURL(file);\n        }\n      });\n    },\n    [selectedLayout, photos.length],\n  );\n\n  const handleAddText = useCallback(\n    (x?: number, y?: number) => {\n      const newText: TextItem = {\n        id: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n        text: 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”',\n        x:\n          x !== undefined\n            ? x / (isHorizontalMode ? 600 : 400)\n            : 0.5,\n        y:\n          y !== undefined\n            ? y / (isHorizontalMode ? 400 : 600)\n            : 0.5,\n        fontSize: 30,\n        fontFamily: 'Arial',\n        color: '#000000',\n        rotation: 0,\n      };\n      setTexts((prev) => [...prev, newText]);\n    },\n    [selectedLayout],\n  );\n\n  const isHorizontalMode = selectedLayout.id === 'horizontal-2';\n\n  const handleUpdatePhoto = useCallback((id: string, updates: Partial<PhotoItem>) => {\n    setPhotos((prev) =>\n      prev.map((photo) => (photo.id === id ? { ...photo, ...updates } : photo)),\n    );\n  }, []);\n\n  const handleFitPhoto = useCallback(\n    (id: string) => {\n      const photo = photos.find((p) => p.id === id);\n      if (!photo) return;\n\n      const img = new Image();\n      img.onload = () => {\n        // 3x3 ë ˆì´ì•„ì›ƒì˜ ê²½ìš° ì••ì¶•ëœ ì´ë¯¸ì§€ í¬ê¸°ë¥¼ ê³ ë ¤\n        let imageWidth = img.width;\n        let imageHeight = img.height;\n        \n        if (selectedLayout.id === 'grid-9') {\n          // ì••ì¶•ëœ ì´ë¯¸ì§€ì˜ ì‹¤ì œ í¬ê¸° ê³„ì‚°\n          const maxWidth = 1200;\n          const maxHeight = 1200;\n          \n          if (img.width > maxWidth || img.height > maxHeight) {\n            const ratio = Math.min(maxWidth / img.width, maxHeight / img.height);\n            imageWidth = img.width * ratio;\n            imageHeight = img.height * ratio;\n          }\n        }\n\n        let optimalScale;\n        \n        if (selectedLayout.id === 'single') {\n          // 1x1 ë ˆì´ì•„ì›ƒ: 4x6 ì¸í™”ì§€ ë¹„ìœ¨ (2:3) ê³ ë ¤\n          const canvasWidth = 1600;\n          const canvasHeight = 2400;\n          const frameWidth = photo.slotWidth * canvasWidth;\n          const frameHeight = photo.slotHeight * canvasHeight;\n          \n          // ì´ë¯¸ì§€ê°€ í”„ë ˆì„ì„ ì™„ì „íˆ ì±„ìš°ë„ë¡ í•˜ë˜, ì›ë³¸ ë¹„ìœ¨ ìœ ì§€\n          const scaleX = frameWidth / imageWidth;\n          const scaleY = frameHeight / imageHeight;\n          \n          // ë” í° ìŠ¤ì¼€ì¼ì„ ì‚¬ìš©í•˜ì—¬ í”„ë ˆì„ì„ ì™„ì „íˆ ì±„ì›€ (crop íš¨ê³¼)\n          optimalScale = Math.max(scaleX, scaleY);\n        } else {\n          // ë‹¤ë¥¸ ë ˆì´ì•„ì›ƒë“¤ì˜ ê¸°ì¡´ ë¡œì§ ìœ ì§€\n          const frameAspectRatio = photo.slotWidth / photo.slotHeight;\n          const imageAspectRatio = imageWidth / imageHeight;\n\n          if (imageAspectRatio > frameAspectRatio) {\n            optimalScale =\n              (photo.slotWidth *\n                (selectedLayout.id === 'horizontal-2' ? 2400 : 1600)) /\n              imageWidth;\n          } else {\n            optimalScale =\n              (photo.slotHeight *\n                (selectedLayout.id === 'horizontal-2' ? 1600 : 2400)) /\n              imageHeight;\n          }\n        }\n\n        handleUpdatePhoto(id, {\n          scale: optimalScale,\n          x: 0,\n          y: 0,\n        });\n      };\n      img.src = photo.src;\n    },\n    [photos, selectedLayout, handleUpdatePhoto],\n  );\n\n  const handleApplyScaleToAll = useCallback(\n    (sourceId: string) => {\n      const sourcePhoto = photos.find((p) => p.id === sourceId);\n      if (!sourcePhoto) return;\n\n      // ë°°ì¹˜ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ëª¨ë“  ë³€ê²½ì‚¬í•­ì„ í•œ ë²ˆì— ì ìš©\n      const updatedPhotos = photos.map((photo) => {\n        if (photo.id !== sourceId) {\n          return {\n            ...photo,\n            scale: sourcePhoto.scale,\n          };\n        }\n        return photo;\n      });\n\n      // í•œ ë²ˆì— ëª¨ë“  ì‚¬ì§„ ì—…ë°ì´íŠ¸\n      setPhotos(updatedPhotos);\n    },\n    [photos],\n  );\n\n  const handleUpdateText = useCallback((id: string, updates: Partial<TextItem>) => {\n    setTexts((prev) =>\n      prev.map((text) => (text.id === id ? { ...text, ...updates } : text)),\n    );\n  }, []);\n\n  const handleDeletePhoto = useCallback((id: string) => {\n    setPhotos((prev) => prev.filter((photo) => photo.id !== id));\n  }, []);\n\n  const handleDeleteText = useCallback((id: string) => {\n    setTexts((prev) => prev.filter((text) => text.id !== id));\n  }, []);\n\n  const handleLayoutChange = useCallback((layout: LayoutTemplate) => {\n    setSelectedLayout(layout);\n    setPhotos([]);\n    setTexts([]);\n  }, []);\n\n  const handlePrint = useCallback(() => {\n    if (canvasRef.current) {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n\n      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n      const dpr = window.devicePixelRatio || 1;\n      const CANVAS_WIDTH = isHorizontalMode ? 2400 : 1600;\n      const CANVAS_HEIGHT = isHorizontalMode ? 1600 : 2400;\n\n      // 1x2 ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ê²½ìš° ì„¸ë¡œ ìš©ì§€ì— ë§ê²Œ ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì •\n      let finalCanvasWidth, finalCanvasHeight;\n      if (isHorizontalMode) {\n        finalCanvasWidth = 1600;  // ì„¸ë¡œ ìš©ì§€ ë„ˆë¹„\n        finalCanvasHeight = 2400; // ì„¸ë¡œ ìš©ì§€ ë†’ì´\n      } else {\n        finalCanvasWidth = CANVAS_WIDTH;\n        finalCanvasHeight = CANVAS_HEIGHT;\n      }\n\n      // ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ìµœì¢… ì¶œë ¥ í¬ê¸°ë¡œ ì„¤ì •\n      canvas.width = finalCanvasWidth;\n      canvas.height = finalCanvasHeight;\n\n      ctx.clearRect(0, 0, finalCanvasWidth, finalCanvasHeight);\n      ctx.fillStyle = '#ffffff';\n      ctx.fillRect(0, 0, finalCanvasWidth, finalCanvasHeight);\n\n      // ì‚¬ì§„ ë Œë”ë§ì„ ìœ„í•œ Promise ë°°ì—´\n      const photoPromises = photos.map((photo) => {\n        return new Promise<void>((resolve) => {\n          const img = new Image();\n          img.onload = () => {\n            ctx.save();\n\n            // 1x2 ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ê²½ìš° 90ë„ íšŒì „\n            if (isHorizontalMode) {\n              ctx.translate(finalCanvasWidth / 2, finalCanvasHeight / 2);\n              ctx.rotate(Math.PI / 2);\n              ctx.translate(-CANVAS_WIDTH / 2, -CANVAS_HEIGHT / 2);\n            }\n\n            const slotX = photo.slotX * CANVAS_WIDTH;\n            const slotY = photo.slotY * CANVAS_HEIGHT;\n            const slotWidth = photo.slotWidth * CANVAS_WIDTH;\n            const slotHeight = photo.slotHeight * CANVAS_HEIGHT;\n\n            ctx.beginPath();\n            ctx.rect(slotX, slotY, slotWidth, slotHeight);\n            ctx.clip();\n\n            const photoX = slotX + slotWidth / 2 + photo.x * slotWidth;\n            const photoY = slotY + slotHeight / 2 + photo.y * slotHeight;\n\n            ctx.translate(photoX, photoY);\n            ctx.rotate((photo.rotation * Math.PI) / 180);\n\n            const drawWidth = img.width * photo.scale;\n            const drawHeight = img.height * photo.scale;\n\n            ctx.drawImage(img, -drawWidth / 2, -drawHeight / 2, drawWidth, drawHeight);\n            ctx.restore();\n            resolve();\n          };\n          img.onerror = () => resolve(); // ì—ëŸ¬ê°€ ë°œìƒí•´ë„ ê³„ì† ì§„í–‰\n          img.src = photo.src;\n        });\n      });\n\n      // ëª¨ë“  ì‚¬ì§„ì´ ë¡œë“œëœ í›„ í…ìŠ¤íŠ¸ ë Œë”ë§ ë° ì €ì¥\n      Promise.all(photoPromises).then(() => {\n        // í…ìŠ¤íŠ¸ ë Œë”ë§\n        texts.forEach((text) => {\n          ctx.save();\n\n          // 1x2 ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ê²½ìš° 90ë„ íšŒì „\n          if (isHorizontalMode) {\n            ctx.translate(finalCanvasWidth / 2, finalCanvasHeight / 2);\n            ctx.rotate(Math.PI / 2);\n            ctx.translate(-CANVAS_WIDTH / 2, -CANVAS_HEIGHT / 2);\n          }\n\n          const x = text.x * CANVAS_WIDTH;\n          const y = text.y * CANVAS_HEIGHT;\n\n          ctx.translate(x, y);\n\n          if (isHorizontalMode) {\n            // ì„¸ë¡œ í…ìŠ¤íŠ¸ (ê°€ë¡œ ëª¨ë“œì—ì„œ)\n            ctx.font = `${text.fontSize * 2}px ${text.fontFamily}, Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji`;\n            ctx.fillStyle = text.color;\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'middle';\n\n            const chars = text.text.split('');\n            const lineHeight = text.fontSize * 2.4;\n            const startY = -(chars.length - 1) * lineHeight / 2;\n\n            chars.forEach((char, index) => {\n              ctx.fillText(char, 0, startY + index * lineHeight);\n            });\n          } else {\n            // ê°€ë¡œ í…ìŠ¤íŠ¸\n            ctx.rotate((text.rotation * Math.PI) / 180);\n            ctx.font = `${text.fontSize * 2}px ${text.fontFamily}, Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji`;\n            ctx.fillStyle = text.color;\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'middle';\n            ctx.fillText(text.text, 0, 0);\n          }\n\n          ctx.restore();\n        });\n\n        // íŒŒì¼ ë‹¤ìš´ë¡œë“œ\n        setTimeout(() => {\n          const link = document.createElement('a');\n          link.download = 'ì¸í™”ì‚¬ì§„.png';\n          link.href = canvas.toDataURL('image/png', 1.0);\n          link.click();\n\n          // ì›ë³¸ ìº”ë²„ìŠ¤ ìƒíƒœ ë³µì›\n          canvas.width = CANVAS_WIDTH;\n          canvas.height = CANVAS_HEIGHT;\n          ctx.putImageData(imageData, 0, 0);\n        }, 100);\n      });\n    }\n  }, [photos, texts, isHorizontalMode]);\n\n  const handleSystemPrint = useCallback(() => {\n    if (canvasRef.current) {\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n\n      // í˜„ì¬ ìº”ë²„ìŠ¤ ìƒíƒœ ì €ì¥\n      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n      // ìº”ë²„ìŠ¤ í¬ê¸° ìƒìˆ˜ ì •ì˜\n      const CANVAS_WIDTH = isHorizontalMode ? 2400 : 1600;\n      const CANVAS_HEIGHT = isHorizontalMode ? 1600 : 2400;\n\n      // 1x2 ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ê²½ìš° ì¸ì‡„ìš© ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ì„¸ë¡œë¡œ ì„¤ì •\n      let printCanvasWidth, printCanvasHeight;\n      if (isHorizontalMode) {\n        // ê°€ë¡œ ë ˆì´ì•„ì›ƒì„ ì„¸ë¡œ ìš©ì§€ì— ì¸ì‡„í•˜ê¸° ìœ„í•´ 90ë„ íšŒì „\n        printCanvasWidth = 1600;  // ì„¸ë¡œ ìš©ì§€ ë„ˆë¹„\n        printCanvasHeight = 2400; // ì„¸ë¡œ ìš©ì§€ ë†’ì´\n      } else {\n        printCanvasWidth = CANVAS_WIDTH;\n        printCanvasHeight = CANVAS_HEIGHT;\n      }\n\n      // ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ì¸ì‡„ìš©ìœ¼ë¡œ ì„¤ì •\n      canvas.width = printCanvasWidth;\n      canvas.height = printCanvasHeight;\n\n      // ìº”ë²„ìŠ¤ ì´ˆê¸°í™” ë° ê³ í•´ìƒë„ ë Œë”ë§\n      ctx.clearRect(0, 0, printCanvasWidth, printCanvasHeight);\n      ctx.fillStyle = '#ffffff';\n      ctx.fillRect(0, 0, printCanvasWidth, printCanvasHeight);\n\n      const renderAndPrint = () => {\n        // 1x2 ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ê²½ìš° 90ë„ íšŒì „í•˜ì—¬ ë Œë”ë§\n        if (isHorizontalMode) {\n          ctx.save();\n          // ìº”ë²„ìŠ¤ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™ í›„ 90ë„ íšŒì „\n          ctx.translate(printCanvasWidth / 2, printCanvasHeight / 2);\n          ctx.rotate(Math.PI / 2);\n          ctx.translate(-CANVAS_WIDTH / 2, -CANVAS_HEIGHT / 2);\n        }\n\n        // í…ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°\n        texts.forEach((text) => {\n          ctx.save();\n          const x = text.x * CANVAS_WIDTH;\n          const y = text.y * CANVAS_HEIGHT;\n\n          ctx.translate(x, y);\n\n          if (isHorizontalMode) {\n            ctx.font = `${text.fontSize * 2}px ${text.fontFamily}, Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji`;\n            ctx.fillStyle = text.color;\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'middle';\n\n            const chars = text.text.split('');\n            const lineHeight = text.fontSize * 2.4;\n            const startY = -(chars.length - 1) * lineHeight / 2;\n\n            chars.forEach((char, index) => {\n              ctx.fillText(char, 0, startY + index * lineHeight);\n            });\n          } else {\n            ctx.rotate((text.rotation * Math.PI) / 180);\n            ctx.font = `${text.fontSize * 2}px ${text.fontFamily}, Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji`;\n            ctx.fillStyle = text.color;\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'middle';\n            ctx.fillText(text.text, 0, 0);\n          }\n\n          ctx.restore();\n        });\n\n        // 1x2 ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ê²½ìš° íšŒì „ ìƒíƒœ ë³µì›\n        if (isHorizontalMode) {\n          ctx.restore();\n        }\n\n        // ìº”ë²„ìŠ¤ë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜í•˜ì—¬ ì„ì‹œ ì´ë¯¸ì§€ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±\n        const imageUrl = canvas.toDataURL('image/png', 1.0);\n\n        // ê¸°ì¡´ ì¸ì‡„ìš© ìš”ì†Œë“¤ ëª¨ë‘ ì œê±°\n        const existingElements = document.querySelectorAll('[id^=\"print-\"]');\n        existingElements.forEach((el) => el.remove());\n\n        // ì¸ì‡„ìš© ì´ë¯¸ì§€ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„± (ë‹¨ í•˜ë‚˜ë§Œ)\n        const printImage = document.createElement('img');\n        printImage.id = 'print-image-single';\n        printImage.src = imageUrl;\n        printImage.style.cssText = `\n          position: fixed;\n          top: -9999px;\n          left: -9999px;\n          width: 100%;\n          height: auto;\n          z-index: 9999;\n          display: none;\n        `;\n\n        // ì¸ì‡„ìš© ìŠ¤íƒ€ì¼ ì¶”ê°€\n        const printStyle = document.createElement('style');\n        printStyle.id = 'print-style-single';\n        printStyle.textContent = `\n          @media print {\n            body * {\n              visibility: hidden !important;\n              display: none !important;\n            }\n            #print-image-single {\n              visibility: visible !important;\n              display: block !important;\n              position: fixed !important;\n              top: 0 !important;\n              left: 0 !important;\n              width: 100% !important;\n              height: auto !important;\n              max-width: none !important;\n              max-height: none !important;\n              margin: 0 !important;\n              padding: 0 !important;\n              page-break-inside: avoid;\n              z-index: 99999 !important;\n            }\n            @page {\n              margin: 0;\n              size: portrait;\n            }\n          }\n        `;\n\n        // DOMì— ì¶”ê°€\n        document.head.appendChild(printStyle);\n        document.body.appendChild(printImage);\n\n        // ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì¸ì‡„\n        printImage.onload = () => {\n          setTimeout(() => {\n            window.print();\n\n            // ì¸ì‡„ í›„ ì •ë¦¬\n            setTimeout(() => {\n              printImage.remove();\n              printStyle.remove();\n              // ì›ë³¸ ìº”ë²„ìŠ¤ ìƒíƒœ ë³µì›\n              canvas.width = CANVAS_WIDTH;\n              canvas.height = CANVAS_HEIGHT;\n              ctx.putImageData(imageData, 0, 0);\n            }, 1000);\n          }, 100);\n        };\n      };\n\n      if (photos.length === 0) {\n        renderAndPrint();\n        return;\n      }\n\n      // ì‚¬ì§„ ë¡œë“œ ë° ê·¸ë¦¬ê¸° - í•œ ë²ˆë§Œ ì²˜ë¦¬\n      let loadedCount = 0;\n      const totalPhotos = photos.length;\n\n      photos.forEach((photo) => {\n        const img = new Image();\n        img.crossOrigin = 'anonymous';\n        img.onload = () => {\n          ctx.save();\n\n          // 1x2 ê°€ë¡œ ë ˆì´ì•„ì›ƒì˜ ê²½ìš° 90ë„ íšŒì „\n          if (isHorizontalMode) {\n            ctx.translate(printCanvasWidth / 2, printCanvasHeight / 2);\n            ctx.rotate(Math.PI / 2);\n            ctx.translate(-CANVAS_WIDTH / 2, -CANVAS_HEIGHT / 2);\n          }\n\n          const slotX = photo.slotX * CANVAS_WIDTH;\n          const slotY = photo.slotY * CANVAS_HEIGHT;\n          const slotWidth = photo.slotWidth * CANVAS_WIDTH;\n          const slotHeight = photo.slotHeight * CANVAS_HEIGHT;\n\n          ctx.beginPath();\n          ctx.rect(slotX, slotY, slotWidth, slotHeight);\n          ctx.clip();\n\n          const photoX = slotX + slotWidth / 2 + photo.x * slotWidth;\n          const photoY = slotY + slotHeight / 2 + photo.y * slotHeight;\n\n          ctx.translate(photoX, photoY);\n          ctx.rotate((photo.rotation * Math.PI) / 180);\n\n          const drawWidth = img.width * photo.scale;\n          const drawHeight = img.height * photo.scale;\n\n          ctx.drawImage(img, -drawWidth / 2, -drawHeight / 2, drawWidth, drawHeight);\n          ctx.restore();\n\n          loadedCount++;\n          if (loadedCount === totalPhotos) {\n            renderAndPrint();\n          }\n        };\n        img.onerror = () => {\n          console.error('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', photo.src);\n          loadedCount++;\n          if (loadedCount === totalPhotos) {\n            renderAndPrint();\n          }\n        };\n        img.src = photo.src;\n      });\n    }\n  }, [photos, texts, isHorizontalMode]);\n\n  const handleTextModeToggle = useCallback(() => {\n    // í…ìŠ¤íŠ¸ ì¶”ê°€ ë²„íŠ¼ í´ë¦­ ì‹œ ê¸°ë³¸ 30px í…ìŠ¤íŠ¸ ìƒì„±í•˜ê³  ì‚¬ì§„ í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜\n    handleAddText();\n    setIsTextMode(false);\n  }, [handleAddText]);\n\n  useEffect(() => {\n    // ì• ë“œì„¼ìŠ¤ ê´‘ê³  ë¡œë“œ\n    try {\n      ((window as any).adsbygoogle = (window as any).adsbygoogle || []).push({});\n    } catch (e) {\n      console.error('AdSense error:', e);\n    }\n  }, []);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* í—¤ë” */}\n      <header className=\"bg-white shadow-sm border-b\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between flex-wrap gap-3\">\n            <h1 className=\"text-lg sm:text-xl md:text-3xl font-bold text-gray-900\">\n              ì˜¤ìš°ì˜ˆ ì…€í”„ìŠ¤íŠœë””ì˜¤ ì‚¬ì§„ í¸ì§‘ê¸°\n            </h1>\n            <div className=\"flex items-center space-x-2 sm:space-x-3\">\n              <button\n                onClick={handlePrint}\n                className=\"bg-green-600 hover:bg-green-700 text-white px-3 sm:px-6 py-2 rounded-lg font-medium transition-colors whitespace-nowrap cursor-pointer text-sm sm:text-base\"\n              >\n                <i className=\"ri-download-line mr-1 sm:mr-2\"></i>\n                <span className=\"hidden sm:inline\">íŒŒì¼ë¡œ ì €ì¥í•˜ê¸°</span>\n                <span className=\"sm:hidden\">ì €ì¥</span>\n              </button>\n              <button\n                onClick={handleSystemPrint}\n                className=\"bg-blue-600 hover:bg-blue-700 text-white px-3 sm:px-6 py-2 rounded-lg font-medium transition-colors whitespace-nowrap cursor-pointer text-sm sm:text-base\"\n              >\n                <i className=\"ri-printer-line mr-1 sm:mr-2\"></i>\n                <span className=\"hidden sm:inline\">ì¸ì‡„í•˜ê¸°</span>\n                <span className=\"sm:hidden\">ì¸ì‡„</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"max-w-7xl mx-auto px-4 py-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n          {/* ì™¼ìª½ ë„êµ¬ íŒ¨ë„ */}\n          <div className=\"lg:col-span-1 space-y-6\">\n            {/* ë ˆì´ì•„ì›ƒ ì„ íƒ */}\n            <div className=\"bg-white rounded-lg shadow-sm p-4\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">ë ˆì´ì•„ì›ƒ ì„ íƒ</h3>\n              <LayoutSelector\n                layouts={layouts}\n                selectedLayout={selectedLayout}\n                onLayoutChange={handleLayoutChange}\n              />\n            </div>\n\n            {/* ì‚¬ì§„ ì—…ë¡œë“œ */}\n            <div className=\"bg-white rounded-lg shadow-sm p-4\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">ì‚¬ì§„ ì—…ë¡œë“œ</h3>\n              <PhotoUploader onUpload={handlePhotoUpload} />\n            </div>\n\n            {/* ëª¨ë“œ ì „í™˜ */}\n            <div className=\"bg-white rounded-lg shadow-sm p-4\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">í¸ì§‘ ëª¨ë“œ</h3>\n              <div className=\"space-y-2\">\n                <button\n                  onClick={() => setIsTextMode(false)}\n                  className={`w-full px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap cursor-pointer ${\n                    !isTextMode\n                      ? 'bg-blue-600 text-white'\n                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                  }`}\n                >\n                  <i className=\"ri-image-line mr-2\"></i>\n                  ì‚¬ì§„ í¸ì§‘\n                </button>\n                <button\n                  onClick={handleTextModeToggle}\n                  className=\"w-full px-4 py-2 rounded-lg font-medium transition-colors whitespace-nowrap cursor-pointer bg-gray-100 text-gray-700 hover:bg-gray-200\"\n                >\n                  <i className=\"ri-text mr-2\"></i>\n                  í…ìŠ¤íŠ¸ ì¶”ê°€\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* ì¤‘ì•™ ìº”ë²„ìŠ¤ */}\n          <div className=\"lg:col-span-2\">\n            <div className=\"bg-white rounded-lg shadow-sm p-6\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">{selectedLayout.name}</h3>\n              <div className=\"flex justify-center\">\n                <PhotoCanvas\n                  ref={canvasRef}\n                  photos={photos}\n                  texts={texts}\n                  layout={selectedLayout}\n                  isTextMode={isTextMode}\n                  onAddText={handleAddText}\n                  onUpdatePhoto={handleUpdatePhoto}\n                  onUpdateText={handleUpdateText}\n                  showGuides={true}\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* ì˜¤ë¥¸ìª½ í¸ì§‘ íŒ¨ë„ */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"bg-white rounded-lg shadow-sm p-4\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">í¸ì§‘ ë„êµ¬</h3>\n\n              {/* ì‚¬ì§„ ëª©ë¡ */}\n              {photos.length > 0 && (\n                <div className=\"mb-6\">\n                  <h4 className=\"font-medium mb-2 text-gray-700\">ì‚¬ì§„ ëª©ë¡</h4>\n                  <div className=\"space-y-2\">\n                    {photos\n                      .sort((a, b) => {\n                        if (Math.abs(a.slotY - b.slotY) < 0.01) {\n                          return a.slotX - b.slotX;\n                        }\n                        return a.slotY - b.slotY;\n                      })\n                      .map((photo, index) => (\n                        <div key={photo.id} className=\"flex items-center justify-between p-2 bg-gray-50 rounded\">\n                          <span className=\"text-sm text-gray-600\">ì‚¬ì§„ {index + 1}</span>\n                          <div className=\"flex items-center space-x-2\">\n                            <button\n                              onClick={() => handleUpdatePhoto(photo.id, { scale: photo.scale + 0.01 })}\n                              className=\"text-blue-500 hover:text-blue-700 cursor-pointer\"\n                              title=\"í™•ëŒ€\"\n                            >\n                              <i className=\"ri-zoom-in-line\"></i>\n                            </button>\n                            <button\n                              onClick={() =>\n                                handleUpdatePhoto(photo.id, { scale: Math.max(photo.scale - 0.01, 0.01) })\n                              }\n                              className=\"text-blue-500 hover:text-blue-700 cursor-pointer\"\n                              title=\"ì¶•ì†Œ\"\n                            >\n                              <i className=\"ri-zoom-out-line\"></i>\n                            </button>\n                            <button\n                              onClick={() => handleApplyScaleToAll(photo.id)}\n                              className=\"text-purple-500 hover:text-purple-700 cursor-pointer\"\n                              title=\"ëª¨ë“  ì‚¬ì§„ì— ë™ì¼í•œ í™•ëŒ€ìœ¨ ì ìš©\"\n                            >\n                              <i className=\"ri-search-line\"></i>\n                            </button>\n                            <button\n                              onClick={() => handleFitPhoto(photo.id)}\n                              className=\"text-green-500 hover:text-green-700 cursor-pointer\"\n                              title=\"í”„ë ˆì„ì— ë§ì¶¤\"\n                            >\n                              <i className=\"ri-restart-line\"></i>\n                            </button>\n                            <button\n                              onClick={() => handleDeletePhoto(photo.id)}\n                              className=\"text-red-500 hover:text-red-700 cursor-pointer\"\n                            >\n                              <i className=\"ri-delete-bin-line\"></i>\n                            </button>\n                          </div>\n                        </div>\n                      ))}\n                  </div>\n                </div>\n              )}\n\n              {/* í…ìŠ¤íŠ¸ í¸ì§‘ */}\n              {texts.length > 0 && (\n                <TextEditor texts={texts} onUpdateText={handleUpdateText} onDeleteText={handleDeleteText} />\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* í•˜ë‹¨ ê´‘ê³  ì˜ì—­ */}\n      <div className=\"max-w-7xl mx-auto px-4 py-6\">\n        <div className=\"bg-white rounded-lg shadow-sm p-4\">\n          <div className=\"text-center text-xs text-gray-400 mb-2\">Advertisement</div>\n          <ins className=\"adsbygoogle\"\n               style={{ display: 'block' }}\n               data-ad-client=\"ca-pub-9037816875196395\"\n               data-ad-slot=\"auto\"\n               data-ad-format=\"auto\"\n               data-full-width-responsive=\"true\"></ins>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["debounce","func","wait","timeout","args","PhotoCanvas","forwardRef","photos","texts","layout","isTextMode","onAddText","onUpdatePhoto","onUpdateText","showGuides","ref","canvasRef","useRef","isDragging","setIsDragging","useState","dragTarget","setDragTarget","dragOffset","setDragOffset","loadedImages","setLoadedImages","isRendering","setIsRendering","fontsLoaded","setFontsLoaded","renderTimeoutRef","useEffect","error","isHorizontalMode","CANVAS_WIDTH","CANVAS_HEIGHT","getDisplaySize","isMobile","isTablet","maxWidth","displaySize","setDisplaySize","handleResize","loadImages","newLoadedImages","photo","img","resolve","reject","renderCanvasInternal","useCallback","canvas","ctx","slot","x","y","width","height","slotX","slotY","slotWidth","slotHeight","photoX","photoY","originalWidth","originalHeight","drawWidth","drawHeight","text","fontFamily","chars","lineHeight","startY","char","index","debouncedRender","handleCanvasClick","e","rect","getEventPosition","clientX","clientY","handleStart","textWidth","textHeight","relativeX","relativeY","handleMove","newX","newY","p","handleEnd","jsxs","jsx","node","PhotoUploader","onUpload","fileInputRef","handleFileSelect","files","handleDrop","handleDragOver","handleClick","LayoutSelector","layouts","selectedLayout","onLayoutChange","fontOptions","specialCharacters","TextEditor","onDeleteText","handleAddSpecialChar","textId","t","charIndex","font","PhotoEditor","setPhotos","setTexts","setSelectedLayout","setIsTextMode","handlePhotoUpload","file","reader","currentPhotoCount","finalImageSrc","finalImageWidth","finalImageHeight","ratio","optimalScale","frameWidth","frameHeight","scaleX","scaleY","frameAspectRatio","newPhoto","prev","handleAddText","newText","handleUpdatePhoto","id","updates","handleFitPhoto","imageWidth","imageHeight","handleApplyScaleToAll","sourceId","sourcePhoto","updatedPhotos","handleUpdateText","handleDeletePhoto","handleDeleteText","handleLayoutChange","handlePrint","imageData","finalCanvasWidth","finalCanvasHeight","photoPromises","link","handleSystemPrint","printCanvasWidth","printCanvasHeight","renderAndPrint","imageUrl","el","printImage","printStyle","loadedCount","totalPhotos","handleTextModeToggle","a","b"],"mappings":"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"}